# üìä Credit Analytics Microservice

> –ú—É–ª—å—Ç–∏–±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç –∫–æ–º–∞–Ω–¥—ã ¬´–¢—Ä–∞–ª–∞–ª–µ–ª–æ¬ª (–∫–∞–ø–∏—Ç–∞–Ω ‚Äî –ê–ª–µ–∫—Å–∞–Ω–¥—Ä) –¥–ª—è —Ç—Ä–µ–∫–∞ HackAPI 2025.

## üß≠ –û–±–∑–æ—Ä

* __–ó–∞—á–µ–º__ ‚Äî –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –∏ –≤–Ω–µ—à–Ω–∏—Ö OpenBanking-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –≤—ã–≥–æ–¥—É —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞—è–≤–∫–∏ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫.
* __–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è__ ‚Äî –∫–∞–∫ iframe-–≤–∏–¥–∂–µ—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –ø–æ—Ä—Ç–∞–ª–µ –±–∞–Ω–∫–∞ –∏–ª–∏ –≤ white-label –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è—Ö –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤.
* __–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏__ ‚Äî Node.js 20 + Express API (`microservices/credit-analytics-backend/src/server.js`) –∏ Vue 3-–≤–∏–¥–∂–µ—Ç (`microservices/credit-analytics-backend/frontend/`).

## üß† –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

1. __–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è__ ‚Äî `GET /api/loans/active` –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ `product-agreements`, –±–∞–ª–∞–Ω—Å—ã –∏ –≤–Ω–µ—à–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç—ã (—Å–º. `src/v1/routes/loans.js`).
2. __–ü–æ–¥–±–æ—Ä —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è__ ‚Äî `GET /api/refinance/suggestions` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂, —ç–∫–æ–Ω–æ–º–∏—é –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (`src/v1/routes/recommendations.js`).
3. __–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏__ ‚Äî `POST /api/refinance/applications` —Å–æ–∑–¥–∞—ë—Ç –¥–æ–≥–æ–≤–æ—Ä —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Bank-in-a-Box.
4. __–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–Ω–∫–æ–≤__ ‚Äî `/api/refinance/banks/health` –∏ `/api/refinance/status` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–Ω–µ—à–Ω–∏—Ö –ø–µ—Å–æ—á–Ω–∏—Ü.

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
    ParentApp[–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–∞–Ω–∫–∞]
    Widget[Credit Analytics Widget (iframe)]
    Backend[Credit Analytics Backend (Express)]
    BankAPI[Bank-in-a-Box API]
    ExternalBanks[–í–Ω–µ—à–Ω–∏–µ –±–∞–Ω–∫–∏ (OpenBanking API)]

    ParentApp -->|postMessage —Ç–æ–∫–µ–Ω| Widget
    Widget -->|REST /api/...| Backend
    Backend -->|Proxy| BankAPI
    Backend -->|OAuth2 sandbox| ExternalBanks
    ExternalBanks -->|–°—á–µ—Ç–∞ –∏ –¥–æ–≥–æ–≤–æ—Ä—ã| Backend
    BankAPI -->|–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, agreements| Backend
    Backend -->|–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ| Widget
    Widget -->|UI —Å–æ–±—ã—Ç–∏—è| ParentApp
```

* __Express —Å–µ—Ä–≤–µ—Ä__ ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç `helmet`, `cors`, `morgan`, –ø–∞—Ä—Å–µ—Ä—ã JSON/URL-encoded, —Ä–∞–∑–¥–∞—ë—Ç `dist/`.
* __–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è__ ‚Äî `src/config/env.js` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç `.env`, —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–Ω–µ—à–Ω–∏—Ö –±–∞–Ω–∫–æ–≤ –∏ —Ç–∞–π–º-–∞—É—Ç—ã.
* __–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏__ ‚Äî `src/lib/bankApiClient.js`, `src/lib/externalLoansService.js`, –º–æ–∫-–¥–∞–Ω–Ω—ã–µ –≤ `src/lib/mockData.js`.
* __–§—Ä–æ–Ω—Ç–µ–Ω–¥__ ‚Äî Vue 3 + Vite iframe —Å –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏ (`components/ApplicationModal.vue`, `components/DataAccessAgreementModal.vue`).

## üöÄ –ó–∞–ø—É—Å–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

```bash
cd microservices/credit-analytics-backend
cp .env.example .env
npm install
npm run dev        # API –∏ –≤–∏–¥–∂–µ—Ç –Ω–∞ http://localhost:8100
```

### –ü—Ä–æ–¥–∞–∫—à–Ω/–¥–µ–º–æ —Ä–µ–∂–∏–º

```bash
cd microservices/credit-analytics-backend
npm install --production
npm run build     # —Å–±–æ—Ä–∫–∞ Vue-–≤–∏–¥–∂–µ—Ç–∞
npm start         # Express —Å–ª—É—à–∞–µ—Ç PORT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8100)
```

–ü–æ–ª—É—á–µ–Ω–Ω—ã–π `dist/` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–∞—ë—Ç—Å—è `express.static`. –°–µ—Ä–≤–∏—Å –ª–µ–≥–∫–æ —É–ø–∞–∫–æ–≤–∞—Ç—å –≤ Docker (—Å–º. `docker-compose.yml`).

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`.env`)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|------------|-----------------------|
| `PORT` | –ü–æ—Ä—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ | `8100`
| `BANK_API_BASE_URL` | –û—Å–Ω–æ–≤–Ω–æ–π Bank-in-a-Box API | `http://localhost:8080`
| `LOCAL_PRODUCT_CATALOG_BASE_URL` | –ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–∞–Ω–∫–∞ | `http://localhost:8080`
| `BANK_API_TIMEOUT_MS` | –¢–∞–π–º-–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Bank API | `10000`
| `EXTERNAL_BANK_TIMEOUT_MS` | –¢–∞–π–º-–∞—É—Ç –≤–Ω–µ—à–Ω–∏—Ö –ø–µ—Å–æ—á–Ω–∏—Ü | `10000`
| `TEAM_CLIENT_ID`, `TEAM_CLIENT_SECRET` | –∫—Ä–µ–¥–µ–Ω—à–ª—ã –∫–æ–º–∞–Ω–¥—ã ¬´–¢—Ä–∞–ª–∞–ª–µ–ª–æ¬ª | –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã HackAPI
| `VBANK_*`, `ABANK_*`, `SBANK_*` | URL –∏ consent ID –≤–Ω–µ—à–Ω–∏—Ö –±–∞–Ω–∫–æ–≤ | —Å–º. `.env.example`
| `USE_MOCK_DATA`, `USE_MOCK_EXTERNAL_BANKS` | –í–∫–ª—é—á–µ–Ω–∏–µ –º–æ–∫–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ | `false`
| `FORCE_REAL_REFINANCE` | –§–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞—è–≤–∫–∏ –≤ mock-—Ä–µ–∂–∏–º–µ | `false`

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚Äî –≤ `microservices/credit-analytics-backend/.env.example`.

## üîå API

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|------|------------|
| GET | `/health` | –°—Ç–∞—Ç—É—Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ |
| GET | `/api/loans/active` | –°–ø–∏—Å–æ–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤ |
| GET | `/api/refinance/suggestions` | –†–∞—Å—á—ë—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤ |
| POST | `/api/refinance/applications` | –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞ —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è |
| GET | `/api/refinance/banks/health` | –õ—ë–≥–∫–∏–π health-check –≤–Ω–µ—à–Ω–∏—Ö –±–∞–Ω–∫–æ–≤ |
| GET | `/api/refinance/status` | –ü–æ–¥—Ä–æ–±–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–Ω–µ—à–Ω–∏—Ö –±–∞–Ω–∫–æ–≤ |

–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <token>`, –∫–æ—Ç–æ—Ä—ã–π iframe –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `postMessage`.

## üñºÔ∏è –í–∏–¥–∂–µ—Ç –∏ UX

* –ö–∞—Ä—Ç–æ—á–∫–∏ –∫—Ä–µ–¥–∏—Ç–æ–≤, —Ä–∞—Å—á—ë—Ç –≤—ã–≥–æ–¥—ã, –º—É–ª—å—Ç–∏–≤—ã–±–æ—Ä –∏ –ø–∞–∫–µ—Ç–Ω—ã–µ –∑–∞—è–≤–∫–∏ (`frontend/credit-analytics/src/App.vue`).
* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞: —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (`components/DataAccessAgreementModal.vue`), –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ (`components/ApplicationModal.vue`).
* –¢–æ—Å—Ç—ã, –∑–∞–≥—Ä—É–∑—á–∏–∫–∏, –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –¥–ª—è desktop/mobile.

## üß™ Mock & Sandbox

* `USE_MOCK_DATA=true` ‚Äî –±—ã—Å—Ç—Ä—ã–π –¥–µ–º–æ-—Ä–µ–∂–∏–º –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –ø–µ—Å–æ—á–Ω–∏—Ü.
* `getMockLoanDetails()` –∏ `getMockBankProducts()` –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≥–æ–Ω—è—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ñ—Ñ–ª–∞–π–Ω.
* Fallback-–ª–æ–≥–∏–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Ç–∞–π–º-–∞—É—Ç–æ–≤ –≤ `externalLoansService.js` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º.

## üìà –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

* `morgan('dev')` –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫.
* –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π error handler (`app.use` –≤ `src/server.js`) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON.
* `/api/refinance/status` –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –º–µ—Ç—Ä–∏–∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–Ω–µ—à–Ω–∏—Ö –±–∞–Ω–∫–æ–≤.

## üó∫Ô∏è –î–∞–ª—å–Ω–µ–π—à–∏–µ –ø–ª–∞–Ω—ã

* __–°–ø—Ä–∏–Ω—Ç 1__ ‚Äî LLM-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤—ã–≥–æ–¥—ã —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.
* __–°–ø—Ä–∏–Ω—Ç 2__ ‚Äî SDK –¥–ª—è iOS/Android –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π white-label —Ç–µ–º–∏–Ω–≥.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ MIT (—Å–º. `LICENSE`).
