# Презентация: Credit Analytics Widget

---

## Слайд 1. Титульный

- Credit Analytics Widget
- Команда «Тралалело»
- Капитан и единственный участник: Александр
- Хакатон HackAPI 2025
- Трек: Open API

---

## Слайд 2. Проблема

- Нет единого инструмента анализа кредитов
   - Сложно оценивать выгоду рефинансирования
   - Высокий порог входа для новых финансовых сервисов
   - Пользователи тратят время на сбор и сверку выписок из разных банков или вообще не думают о рефинансировании
   - Отсутствует автоматическая оценка рисков и платежной нагрузки по всем кредитам, а также подсказки выгодных сценариев
   - Банки не видят контекст по клиенту и теряют возможности предложить релевантный продукт
- Финтех-команды вынуждены строить интеграции с каждым банком вручную, что тормозит запуск

---

## Слайд 3. Решение

- Мультибанковский сервис рефинансирования кредитов
- Автоматический сбор данных из разных банков через OpenBanking API
- Автоматизируем сбор выписок и контекста: пользователю не нужно сводить данные из разных банков вручную
- Расчёт выгодных предложений и экономии
- Использование информации о внешних договорах и остатках клиента для расчёта офферов
- Единый интерфейс для клиента и iframe-виджет для интеграции

---

## Слайд 4. Ценность для пользователя

- Консолидация кредитов в одном окне (`frontend/credit-analytics/src/App.vue`)
- Персональные офферы по ставкам и ежемесячным платежам
- Точная визуализация выгоды рефинансирования с расчётом экономии по каждому сценарию
- Автоматический подбор предложений по рефинансированию на основе продуктового каталога банка (`v1/routes/recommendations.js`)
- Возможность объединить несколько кредитов в единую рефинансированную заявку (мультивыбор, `App.vue`)
- Пакетные заявки на рефинансирование напрямую из интерфейса

---

## Слайд 5. Монетизация

- __Реализовано__: аккуратное привлечение клиентов через одобренные рефинансирования. Сервис оформляет заявки (`POST /api/refinance/applications`) и передаёт банку лиды, обеспечивая совместно выгодные условия для клиента и исходного банка.
- __Партнёрские программы__ (план): разделение комиссий за успешно закрытые рефинансирования.
- __Freemium__ (план): базовый просмотр бесплатно, пакетные заявки и автоматические сценарии — премиум.
- __White-label лицензирование__ (план): iframe-виджет для партнёрских финтех-сервисов.
- __API pay-per-use__ (план): тарификация персональных офферов через API.

---

## Слайд 6. Архитектура бекенда

- `src/server.js` — Express API + статика Vue
- Сервисы: `v1/routes/loans.js`, `v1/routes/recommendations.js`
- Интеграции: `lib/externalLoansService.js`, `lib/bankApiClient.js`
- Внешний REST: OpenBanking API (балансы, product-agreements)
- Обновлён админский кабинет основного приложения (`frontend/banker/`): добавление и удаление кредитных предложений без вмешательства разработчиков

---

## Слайд 7. Архитектура: взаимодействие с основным приложением

- Iframe-виджет (`frontend/credit-analytics/`) встраивается в основное клиентское приложение банка
- Токен авторизации передаётся из родительского приложения через `postMessage`
- Бэкенд микросервиса (`credit-analytics-backend/src/server.js`) проксирует запросы к основному Bank API и внешним банкам
- Ответы с договорами и остатками агрегируются и возвращаются в виджет для отображения клиенту

```mermaid
flowchart LR
    ParentApp[Основное приложение банка]
    Widget[Credit Analytics Widget (iframe)]
    Backend[Credit Analytics Backend (Express)]
    BankAPI[Bank-in-a-Box API]
    ExternalBanks[Внешние банки (OpenBanking API)]

    ParentApp -->|postMessage токен| Widget
    Widget -->|REST /api/...| Backend
    Backend -->|Proxy| BankAPI
    Backend -->|OAuth2 sandbox токены| ExternalBanks
    ExternalBanks -->|Счета, договоры, остатки| Backend
    BankAPI -->|Договоры, балансы| Backend
    Backend -->|Агрегированные данные| Widget
    Widget -->|UI события| ParentApp
```

---

## Слайд 8. Технические особенности бэкенда

- Поддерживаемый `GET /health` и middleware ошибок в `microservices/credit-analytics-backend/src/server.js`
- Мониторинг внешних банков через `GET /api/refinance/banks/health` (`microservices/credit-analytics-backend/src/v1/routes/recommendations.js`)
- Агрегация и трейсинг внешних договоров в `microservices/credit-analytics-backend/src/lib/externalLoansService.js`
- `POST /api/refinance/applications` для подачи заявок (`microservices/credit-analytics-backend/src/v1/routes/recommendations.js`)
- Соответствует требованию «Надёжная обработка ошибок и отказов внешних API» из `docs/multibank-requirements.md` благодаря fallback-логике, централизованному перехвату ошибок и тайм-аутам.

---

## Слайд 9. Потоки данных

1. Клиент авторизуется в родительском приложении и передаёт токен iframe (`App.vue`)
2. `/api/loans/active` загружает внутренние и внешние договоры, подтягивает балансы
3. `/api/refinance/suggestions` считает офферы, сравнивает ставки и условия
4. `/api/refinance/applications` создаёт заявку на продукт в Bank API

---

## Слайд 10. Безопасность и комплаенс

- Поддержка Bearer-токенов и прокси OAuth/OIDC через main-бэкенд
- Логи без чувствительных данных (`console.warn/info` с requestId)
- Соответствие стандартам Open API Банка России (см. `docs/multibank-requirements.md`)

---

## Слайд 11. UX и интерфейс

- Адаптивный дизайн, мобильный режим карусели кредитов
- Модальные окна: согласие на доступ (`DataAccessAgreementModal.vue`), заявка (`ApplicationModal.vue`)
- Контекстные подсказки и тосты дают обратную связь пользователю (`.toast`, `.loading`, `.empty-state`)
- Учёт доступности: высокие контрасты, поддержка клавиатурной навигации и фокуса в модалках
- Информационные карточки (баланс, средняя ставка, экономия)
- Выполнено требование «Интуитивный UI/UX» из `docs/multibank-requirements.md`: интерфейс виджета покрывает сценарии без обучения, обеспечивает чистую визуальную иерархию и мгновенный отклик.

---

## Слайд 12. Ключевые особенности

- Поддержка внешних банков
- Расширяемая конфигурация банков
- Готовность к white-label интеграциям за счёт iframe и гибкого UI

---

## Слайд 13. Выгода для банков

- Расширение кредитного портфеля за счёт обслуживания клиентов, которые уже имеют кредиты в других банках
- Быстрое подключение через готовый iframe без затрат на разработку UI
- Повышение конверсии за счёт персональных офферов и мгновенной заявки
- Возможность таргетированных партнёрских программ и кросс-продаж

---

## Слайд 14. Здоровая конкуренция

- Прозрачные условия рефинансирования помогают банкам совместно развивать продуктовую линейку
- Пользователь получает персонализированные предложения и выбирает лучший сервис

---

## Слайд 15. Дорожная карта

- Спринт 1: внедрение LLM для объяснения выгод рефинансирования пользователю
- Спринт 2: Нативные SDK для iOS/Android для упрощения интеграции в мобильные приложения банков

---

## Слайд 16. Call to Action

- Подготовленный .env и sandbox скрипты — готовы к запуску
